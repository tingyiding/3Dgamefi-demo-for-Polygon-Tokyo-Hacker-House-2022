import { useEffect, useState } from "react"

export default (cb: () => void) => {
	const [el, setEl] = useState<HTMLElement | null>(null)

	useEffect(() => {
        if (!el) return

        let down = false

        const handleEl = () => {
            down = true
            setTimeout(() => down = false)
        }
        el.addEventListener("mousedown", handleEl)

        const handleDoc = () => !down && cb()
        document.addEventListener("mousedown", handleDoc)

        return () => {
            el.removeEventListener("mousedown", handleEl)
            document.removeEventListener("mousedown", handleDoc)
        }
    }, [el])

    return setEl
}