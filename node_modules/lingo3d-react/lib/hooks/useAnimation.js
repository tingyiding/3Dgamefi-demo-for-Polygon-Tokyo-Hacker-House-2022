import { usePrevious } from "@lincode/hooks";
import { animate } from "popmotion";
import { useLayoutEffect, useState } from "react";
import useValue from "./useValue";
export default ({ from, to, duration = 1000, stopped, step, ...options }) => {
    const reactive = useValue({ from, step });
    const [r, render] = useState({});
    const rOld = usePrevious(r);
    reactive.restart = () => render({});
    useLayoutEffect(() => {
        if (stopped)
            return;
        const anim = animate({
            from: rOld === r ? reactive.get() : from, to, duration, ...options, onUpdate: reactive.set
        });
        return () => {
            anim.stop();
        };
    }, [to, stopped, r]);
    return reactive;
};
